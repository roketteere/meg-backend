<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0,shrink-to-fit=no" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css"
      integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
      crossorigin="anonymous" />
    <script
      src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
      integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
      crossorigin="anonymous"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.14.3/dist/umd/popper.min.js"
      integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
      crossorigin="anonymous"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js"
      integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
      crossorigin="anonymous"></script>
    <title>Meg Back End</title>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <a class="navbar-brand" href="#">Dashboard: Routes Menu</a>
      <button
        class="navbar-toggler"
        type="button"
        data-toggle="collapse"
        data-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent"
        aria-expanded="false"
        aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item">
            <a class="nav-link" href="/">Root</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/user_help.html">User / Signup</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/login_help.html">Login</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/logout_help.html">Logout</a>
          </li>

          <li class="nav-item">
            <a class="nav-link" href="/er_help.html">Emergency</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/journey_help.html">Journey</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/experience_help.html">Experience</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/rating_help.html">Rating</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/gps_help.html">GPS</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/sms_help.html">SMS_Twilio</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" href="/auth_help.html">Auth</a>
          </li>
        </ul>
      </div>
    </nav>
    <div>
      <h2 class="m-2 p2">Welcome to the MEG App Back End</h2>
    </div>
    <div class="container">
      <h1>Auth Route Info</h1>
      <h3>bcrypt and JWT Usage:</h3>
      <pre class="bg-light p-2">
        <code>
const validPassword = login.checkPassword(password);
if (!validPassword) {
  res.status(400).json({
    message: "Password Invalid",
  });
} else {
  const jwtToken = jwt.sign(
    {
      email: login.email,
      userId: login.id,
    },
    process.env.SESSION_SECRET,
    {
      expiresIn: "3h",
    }
  );
}
        </code>
      </pre>
      <h3>Description:</h3>
      <p>
        The above code snippet demonstrates how bcrypt and JWT (JSON Web Tokens)
        are used for authentication and session management. First, the code
        checks the validity of the provided password using the `checkPassword`
        method of the `login` object. If the password is invalid, a 400 HTTP
        status response is sent indicating the password is incorrect. If the
        password is valid, a JWT token is generated using the `jwt.sign` method.
        The JWT payload includes the user's email and ID for identification
        purposes. The `process.env.SESSION_SECRET` is used as the secret key for
        signing the JWT token. The token is set to expire after 3 hours.
      </p>
    </div>
  </body>
</html>
